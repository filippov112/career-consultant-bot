# Шаблон Telegram-бота на Python (с PostgreSQL и системой баллов)

Этот проект представляет собой шаблон для создания Telegram-бота с использованием библиотеки `python-telegram-bot`, базы данных PostgreSQL и измененной системой тестов.

## Функционал

* **Приветственное сообщение**: При команде `/start` бот приветствует пользователя.
* **Меню**: Бот предоставляет inline-меню для навигации.
* **Тесты с баллами**:
    * Пользователи могут проходить тесты, где за каждый вариант ответа начисляется определенное количество баллов.
    * Итоговый балл суммируется.
    * Отображается максимальный возможный балл за тест.
    * Результаты сохраняются.
* **Информационные сообщения**: Бот может выводить статическую информацию.
* **База данных**: Используется PostgreSQL для хранения данных о пользователях и их результатах тестов.
* **Логическая структура**: Код разделен на модули.
* **Комментарии**: Код снабжен комментариями.

## Установка

1.  **Клонируйте репозиторий (или создайте файлы вручную).**

2.  **Настройте PostgreSQL:**
    * Установите PostgreSQL, если еще не установлен.
    * Создайте базу данных и пользователя для бота. Пример команд в `psql`:
        ```sql
        CREATE DATABASE telegram_bot_db;
        CREATE USER your_db_user WITH PASSWORD 'your_db_password';
        GRANT ALL PRIVILEGES ON DATABASE telegram_bot_db TO your_db_user;
        -- Подключитесь к новой БД: \c telegram_bot_db
        GRANT ALL ON SCHEMA public TO your_db_user; -- Предоставьте права на схему public
        ```
    * Замените `telegram_bot_db`, `your_db_user`, `your_db_password` на ваши значения.

3.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # для Linux/macOS
    # venv\Scripts\activate  # для Windows
    ```

4.  **Установите зависимости:**
    ```bash
    pip install python-telegram-bot==21.0.1 # или более новую версию
    pip install psycopg2-binary
    pip install python-dotenv # Для загрузки конфигурации из .env
    ```

5.  **Создайте и настройте файл конфигурации `.env`:**
    * В корневой директории проекта создайте файл с именем `.env`.
    * Скопируйте в него содержимое из примера ниже и замените значения на ваши:
      ```dotenv
      # .env

      # Токен вашего Telegram бота
      BOT_TOKEN="YOUR_TELEGRAM_BOT_TOKEN"

      # Параметры подключения к PostgreSQL
      DB_HOST="localhost"
      DB_PORT="5432"
      DB_NAME="telegram_bot_db"
      DB_USER="your_db_user"
      DB_PASSWORD="your_db_password"
      ```
    * **Важно**: Если вы используете Git, добавьте `.env` в ваш файл `.gitignore`, чтобы не коммитить секретные данные.

6.  **Инициализируйте базу данных (таблицы):**
    Запустите `python database.py` один раз для создания таблиц в вашей БД PostgreSQL (саму БД и пользователя вы должны были создать на шаге 2).
    ```bash
    python database.py
    ```
    Либо таблицы создадутся при первом запуске `main.py`, если `database.init_db()` там вызывается успешно.

## Запуск бота

Для запуска бота выполните команду:

```bash
python main.py
```

Бот начнет опрашивать Telegram на предмет новых сообщений.

## Структура файлов

* `main.py`: Точка входа приложения.
* `config.py`: Загружает конфигурационные данные из `.env` и предоставляет их другим модулям.
* `.env`: Файл для хранения секретных конфигурационных данных (не коммитится в Git).
* `handlers.py`: Логика обработчиков команд и callback'ов.
* `keyboards.py`: Генерация inline-клавиатур.
* `database.py`: Взаимодействие с PostgreSQL.
* `quizzes_data.py`: Данные для тестов (вопросы, варианты, баллы).
* `README.md`: Этот файл.